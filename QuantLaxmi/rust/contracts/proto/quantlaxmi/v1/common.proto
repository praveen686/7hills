// QuantLaxmi Signal Contract v1 — Shared Types
// Python <-> Rust boundary for live trading hot-path.
//
// Convention: actual_value = mantissa * 10^exponent
// Fixed exponents: confidence=-4 (10000=1.0), spread_bps=-2 (523=5.23 bps)

syntax = "proto3";
package quantlaxmi.v1;

// ──────────────────────────────────────────────
// Fixed-point representation (deterministic, no FP drift)
// ──────────────────────────────────────────────
message FixedPoint {
  int64 mantissa = 1;
  int32 exponent = 2;  // price = mantissa * 10^exponent
}

// ──────────────────────────────────────────────
// Timestamp (nanoseconds since Unix epoch)
// ──────────────────────────────────────────────
message Timestamp {
  int64 nanos = 1;  // UTC nanoseconds since 1970-01-01T00:00:00Z
}

// ──────────────────────────────────────────────
// Enums
// ──────────────────────────────────────────────
enum Side {
  SIDE_UNSPECIFIED = 0;
  SIDE_BUY        = 1;
  SIDE_SELL       = 2;
}

enum Venue {
  VENUE_UNSPECIFIED   = 0;
  VENUE_NSE_FUT       = 1;
  VENUE_NSE_OPT       = 2;
  VENUE_BINANCE_PERP  = 3;
  VENUE_BINANCE_SPOT  = 4;
  VENUE_PAPER         = 5;
}

enum InstrumentType {
  INSTRUMENT_UNSPECIFIED = 0;
  INSTRUMENT_FUT         = 1;
  INSTRUMENT_CE          = 2;
  INSTRUMENT_PE          = 3;
  INSTRUMENT_SPREAD      = 4;
}

enum OrderType {
  ORDER_TYPE_UNSPECIFIED = 0;
  ORDER_TYPE_MARKET      = 1;
  ORDER_TYPE_LIMIT       = 2;
  ORDER_TYPE_SL          = 3;
}

enum OrderStatus {
  ORDER_STATUS_UNSPECIFIED      = 0;
  ORDER_STATUS_PENDING          = 1;
  ORDER_STATUS_ACCEPTED         = 2;
  ORDER_STATUS_REJECTED         = 3;
  ORDER_STATUS_PARTIALLY_FILLED = 4;
  ORDER_STATUS_FILLED           = 5;
  ORDER_STATUS_CANCELLED        = 6;
}

// L1 field presence: 2-bit slot per field in MarketSnapshotV2.l1_state_bits
enum FieldState {
  FIELD_STATE_ABSENT    = 0;  // Vendor didn't send
  FIELD_STATE_NULL      = 1;  // Vendor sent null
  FIELD_STATE_VALUE     = 2;  // Vendor sent valid value
  FIELD_STATE_MALFORMED = 3;  // Could not parse
}

enum IntegrityTier {
  INTEGRITY_TIER_UNSPECIFIED   = 0;
  INTEGRITY_TIER_CERTIFIED     = 1;  // SBE-based capture (production-grade)
  INTEGRITY_TIER_NON_CERTIFIED = 2;  // JSON-based (debugging only)
}

enum Permission {
  PERMISSION_UNSPECIFIED = 0;
  PERMISSION_APPROVED    = 1;
  PERMISSION_REFUSED     = 2;
}

enum FillType {
  FILL_TYPE_UNSPECIFIED = 0;
  FILL_TYPE_FULL        = 1;
  FILL_TYPE_PARTIAL     = 2;
}

// ──────────────────────────────────────────────
// Reusable sub-messages
// ──────────────────────────────────────────────
message CorrelationContext {
  optional string session_id  = 1;
  optional string run_id      = 2;
  optional string symbol      = 3;
  optional string venue       = 4;
  optional string strategy_id = 5;
  optional string decision_id = 6;  // UUID string
  optional string order_id    = 7;  // UUID string
}
